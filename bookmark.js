/**
 * @file bookmark.js
 * @name netscape-bookmark-tree
 * @version 2.1.0 Build.1684223288001
 * @author ZMY
 * @license MIT
 */
import e from"node:os";import{parseFragment as n}from"parse5";function t(e,n,t){const r="    ";function a(e,i){return e.reduce((function(e,o){const{name:c,attributes:s,children:u}=n(o,i),l=i.concat(o),d=i.reduce((e=>e+r),t+r),f=function(e){return e?e.reduce((function(e,n){return`${e} ${n[0].toUpperCase()}="${n[1]}"`}),""):""}(s);let T;if(Array.isArray(u)){const e=a(u,l),n=[`<DT><H3${f}>${c}</H3>`,"<DL><p>",r+e,"</DL><p>"];0===u.length&&n.splice(2,1),T=n.join(d)}else T=`<DT><A${f}>${c}</A>`;return e?e+d+T:T}),"")}return e.map((function(e){const{children:t,name:i}=n(e);let o=a(t,[]);return o=`\n<!DOCTYPE NETSCAPE-Bookmark-file-1>\n\x3c!-- This is an automatically generated file.\n     It will be read and overwritten.\n     DO NOT EDIT! --\x3e\n<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">\n<TITLE>Bookmarks</TITLE>\n<H1>${i}</H1>\n<DL><p>\n${r}${o}\n</DL><p>\n`,o=o.trimStart(),o}))}const r={parseHTML:e=>n(e).childNodes,getTag:e=>e.nodeName,getName:e=>e.childNodes[0].value,setAttrs(e,n){const{attrs:t}=n;return t.map((function(n){return e[n.name]=n.value,[n.name,n.value]}))}},a={parse:{each(e,n){const t=(a=n.parentPath)[a.length-1],r=n.index;var a;return e.index=r,t?(e.id=`${t.id}_${r}`,e.pid=t.id):e.id=r.toString(),e},setChildren(e,n){e.children=n}},stringify:{each:function(e){return e},eol:e.EOL}};function i(e,n){return n=Object.assign({},a.parse,n),function(e,n,t,r){const a=n.replace(/<!DOCTYPE [\s\S]+?<\/TITLE>|<DT>|<p>/g,""),i=function n(a,i){const o=[];return a.forEach((function(a){const c=e.getTag(a);function s(n){const r=o.length;let s={name:e.getName(a)};const u=e.setAttrs(s,a);s=t(s,{parentPath:i,isLeaf:n,index:r,attributes:u,tag:c},a)||s,o.push(s)}if("a"===c)s(!0);else if("h3"===c||"h1"===c)s(!1);else if("dl"===c){const e=o[o.length-1],t=i.concat(e),c=n(a.childNodes,t);r(e,c)}})),o}(e.parseHTML(a),[]);return i}(r,e,n.each,n.setChildren)}function o(e,n){return t(e,(n=Object.assign({},a.stringify,n)).each,n.eol)}export{i as default,a as defaultOptions,i as parse,o as stringify};
